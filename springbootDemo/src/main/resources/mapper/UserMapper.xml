<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="org.cloud.ssm.mapper.UserMapper">

  <resultMap type="User" id="userMap">
    <id column="id" property="id"></id>
    <result column="name" property="name" />
    <result column="age" property="age" />
    <result column="phone" property="phone" />
    <result column="username" property="username" />
    <result column="password" property="password" />
  </resultMap>

  <select id="listUser" resultMap="userMap">
    SELECT *
    FROM t_user
  </select>

  <select id="findUserById" resultMap="userMap" parameterType="long">
    SELECT *
    FROM t_user
    WHERE id=#{id}
  </select>

  <select id="findUserByPhone" resultMap="userMap">
    SELECT *
    FROM t_user
    WHERE phone=#{phone}
  </select>

  <select id="findUserByUserName" resultMap="userMap">
    SELECT *
    FROM t_user
    WHERE username=#{username}
  </select>

  <select id="findUserRole" parameterType="long" resultType="Role">
    SELECT
      t_role.id,
      t_role.role_name AS roleName,
      t_role.role_card AS roleCard
    FROM
      t_user AS u
    LEFT JOIN t_user_role AS ur ON u.id = ur.users_id
    LEFT JOIN t_role ON ur.role_id = t_role.id
    WHERE
      u.id = #{id};
  </select>

</mapper>